# 前端集成新平台指南

## 1. 概述

本文档详细说明如何在前端项目中集成新的视频发布平台，确保新平台能够在视频发布中心正确显示和使用。

## 2. 集成准备工作

### 2.1 平台调研
- 确认新平台的类型编码（后端定义的type字段值）
- 了解新平台是否需要特定的UI元素或参数

### 2.2 环境要求
- 前端项目正常运行环境
- 已完成后端对新平台的支持

## 3. 集成步骤详解

### 3.1 添加平台常量定义

在 `sau_frontend/src/views/PublishCenter.vue` 文件中，找到 `platforms` 数组并添加新平台定义：

```javascript
// 平台列表 - 对应后端type字段
const platforms = [
  { key: 3, name: '抖音' },
  { key: 4, name: '快手' },
  { key: 2, name: '视频号' },
  { key: 1, name: '小红书' },
  { key: 5, name: 'TikTok' },
  { key: 6, name: 'Instagram' }, // 新增平台
  // 更多平台...
]
```

### 3.2 更新账号映射配置

在 `availableAccounts` 计算属性中，更新 `platformMap` 对象以支持新平台账号过滤：

```javascript
const availableAccounts = computed(() => {
  const platformMap = {
    3: '抖音',
    2: '视频号',
    1: '小红书',
    4: '快手',
    5: 'TikTok',
    6: 'Instagram', // 新增平台映射
    // 更多平台...
  }
  const currentPlatform = currentTab.value ? platformMap[currentTab.value.selectedPlatform] : null
  return currentPlatform ? accountStore.accounts.filter(acc => acc.platform === currentPlatform) : []
})
```

### 3.3 添加平台特定UI元素（可选）

如果新平台需要特定的UI元素（如抖音的商品链接），可以使用条件渲染添加：

```vue
<!-- 新平台特定UI元素 -->
<div v-if="tab.selectedPlatform === 新平台ID" class="new-platform-section">
  <h3>特定参数</h3>
  <!-- 添加需要的输入框或其他组件 -->
</div>
```

### 3.4 确保API调用支持

确认 `confirmPublish` 函数中的数据格式与后端API兼容，特别是以下字段：
- `type`: 平台类型编码
- `accountList`: 账号文件路径列表
- `fileList`: 视频文件路径列表
- `enableTimer`: 定时发布开关
- 其他平台特定参数

### 3.5 更新账号Store平台映射配置

**必须步骤**：在 `sau_frontend/src/stores/account.js` 文件中，更新 `platformTypes` 对象以支持新平台的类型映射，这是确保账号在管理页面正确显示平台名称的关键步骤：

```javascript
// 平台类型映射
const platformTypes = {
  1: '小红书',
  2: '视频号',
  3: '抖音',
  4: '快手',
  5: 'TikTok',
  6: 'Instagram', // 新增平台映射
  // 更多平台...
}

## 4. 平台特定功能实现指南

### 4.1 平台特有参数
- 对于需要特殊参数的平台，在 `defaultTabInit` 对象中添加相应的属性
- 在 `confirmPublish` 函数中将这些属性添加到 `publishData` 中

### 4.2 账号过滤
- 确保 `availableAccounts` 计算属性能正确过滤出对应平台的账号
- 账号对象中的 `platform` 字段值应与 `platformMap` 中的值匹配

## 5. 测试与验证

### 5.1 功能验证
- 确认新平台选项在平台选择区域显示
- 验证可以选择新平台的账号
- 测试视频发布功能，确保数据正确发送到后端

### 5.2 错误处理
- 验证平台选择、账号选择等必要字段的验证逻辑
- 测试发布失败时的错误提示

## 6. 最佳实践

### 6.1 代码规范
- 保持平台列表和映射对象的一致性
- 为新添加的代码添加适当的注释
- 遵循项目现有的命名规范

### 6.2 可维护性
- 将平台相关的常量和映射集中管理
- 考虑使用配置文件管理平台信息，便于后续扩展

## 7. 附录

### 7.1 平台类型编码表

| 平台 | 类型编码 | 平台名称 |
| --- | --- | --- |
| 小红书 | 1 | 小红书 |
| 视频号 | 2 | 视频号 |
| 抖音 | 3 | 抖音 |
| 快手 | 4 | 快手 |
| TikTok | 5 | TikTok |
| Instagram | 6 | Instagram |

### 7.2 前端架构概览
- 视频发布页面：`sau_frontend/src/views/PublishCenter.vue`
- API调用模块：`sau_frontend/src/api/publish.js`
- 账号管理：`sau_frontend/src/stores/account.js`

## 8. Instagram平台集成案例

### 8.1 集成内容摘要
已完成Instagram平台在前端系统中的完整集成，包括账号管理和网站管理功能。

### 8.2 具体实施步骤

#### 8.2.1 资源文件准备
- 创建Instagram图标资源：`sau_frontend/src/assets/instagram.svg`

#### 8.2.2 账号管理页面集成
在`AccountManagement.vue`文件中进行以下修改：
- 添加Instagram平台选择器选项
- 新增Instagram账号标签页
- 导入instagram.svg图标文件
- 更新platformTypeMap映射（Instagram为类型6）
- 添加Instagram账号过滤计算属性

#### 8.2.3 更新账号Store平台映射
在`sau_frontend/src/stores/account.js`文件中添加Instagram平台的类型映射：
```javascript
// 平台类型映射
const platformTypes = {
  1: '小红书',
  2: '视频号',
  3: '抖音',
  4: '快手',
  5: 'TikTok',
  6: 'Instagram', // 添加Instagram映射
}
```

#### 8.2.3 网站管理页面集成
在`Website.vue`文件中添加Instagram平台配置：
```javascript
// 添加Instagram平台配置
{
  platform: 'Instagram',
  url: 'https://www.instagram.com',
  status: 'active'
}
```

### 8.3 集成结果
- 账号管理页面现在支持添加、编辑、删除Instagram平台账号
- 网站管理页面显示Instagram平台配置信息
- 平台类型编码6已正确映射到Instagram平台

### 8.4 经验总结
- 确保平台类型编码在整个系统中保持一致
- 为新平台准备适当的图标资源
- 按照平台集成流程逐步实施，确保各模块正确对接